/*
 * Timer compilation example.
 * 
 * This example is used only for checking constexpr function that compute prescaler/OCR values for given delay.
 */

#include <fastarduino/Timer.hh>

using TIMER0 = Timer<Board::Timer::TIMER0>;
using TIMER1 = Timer<Board::Timer::TIMER1>;
using TIMER2 = Timer<Board::Timer::TIMER2>;

#define ASSERT0(us, p, c)													\
static_assert(TIMER0::prescaler(us) == p, "");								\
static_assert(TIMER0::counter(TIMER0::prescaler(us), us) == c, "");

#define ASSERT1(us, p, c)													\
static_assert(TIMER1::prescaler(us) == p, "");								\
static_assert(TIMER1::counter(TIMER1::prescaler(us), us) == c, "");

#define ASSERT2(us, p, c)													\
static_assert(TIMER2::prescaler(us) == p, "");								\
static_assert(TIMER2::counter(TIMER2::prescaler(us), us) == c, "");

ASSERT0(1, TIMER0::TIMER_PRESCALER::NO_PRESCALING, 0x0F)
ASSERT0(10, TIMER0::TIMER_PRESCALER::NO_PRESCALING, 0x9F)
ASSERT0(100, TIMER0::TIMER_PRESCALER::DIV_8, 0xC7)
ASSERT0(500, TIMER0::TIMER_PRESCALER::DIV_64, 0x7C)
ASSERT0(1000, TIMER0::TIMER_PRESCALER::DIV_64, 0xF9)
ASSERT0(2000, TIMER0::TIMER_PRESCALER::DIV_256, 0x7C)
ASSERT0(10000, TIMER0::TIMER_PRESCALER::DIV_1024, 0x9B)
ASSERT0(16000, TIMER0::TIMER_PRESCALER::DIV_1024, 0xF9)

ASSERT1(1, TIMER1::TIMER_PRESCALER::NO_PRESCALING, 0x000F)
ASSERT1(10, TIMER1::TIMER_PRESCALER::NO_PRESCALING, 0x009F)
ASSERT1(100, TIMER1::TIMER_PRESCALER::NO_PRESCALING, 0x063F)
ASSERT1(1000, TIMER1::TIMER_PRESCALER::NO_PRESCALING, 0x3E7F)
ASSERT1(10000, TIMER1::TIMER_PRESCALER::DIV_8, 0x4E1F)
ASSERT1(100000, TIMER1::TIMER_PRESCALER::DIV_64, 0x61A7)
ASSERT1(1000000, TIMER1::TIMER_PRESCALER::DIV_256, 0xF423)
ASSERT1(4000000, TIMER1::TIMER_PRESCALER::DIV_1024, 0xF423)

ASSERT2(1, TIMER2::TIMER_PRESCALER::NO_PRESCALING, 0x0F)
ASSERT2(10, TIMER2::TIMER_PRESCALER::NO_PRESCALING, 0x9F)
ASSERT2(100, TIMER2::TIMER_PRESCALER::DIV_8, 0xC7)
ASSERT2(500, TIMER2::TIMER_PRESCALER::DIV_32, 0xF9)
ASSERT2(1000, TIMER2::TIMER_PRESCALER::DIV_64, 0xF9)
ASSERT2(2000, TIMER2::TIMER_PRESCALER::DIV_128, 0xF9)
ASSERT2(10000, TIMER2::TIMER_PRESCALER::DIV_1024, 0x9B)
ASSERT2(16000, TIMER2::TIMER_PRESCALER::DIV_1024, 0xF9)

int main()
{
}
